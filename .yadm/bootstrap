#!/bin/bash
# Requirements:
# yadm-git
# yaourt

# INSTALL DEPENDENCIES
echo "installing dependencies"
sudo pacman -S zsh zsh-completions neovim git ripgrep fzy tmux python-pip \
  trash-cli openssh --noconfirm --needed
yaourt -S universal-ctags yay-bin --noconfirm --needed

# ZSH

if [ `ls -A ~/.zim/ | wc -m` == "0" ]; then
  echo "bootstraping ZSH"
  chsh -s /usr/bin/zsh
  git clone --recursive https://github.com/zimfw/zimfw.git ~/.zim
fi

# INSTALL TMUX  PLUGINS
if [ `ls -A ~/.tmux/plugins/tpm | wc -m` == "0" ]; then
  echo "bootstraping tmux"
   git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && \
    ~/.tmux/plugins/tpm/scripts/install_plugins.sh
fi

# INSTALL NEOVIM PLUGINS
if command -v nvim >/dev/null 2>&1; then
  echo "Bootstraping NeoVim"

  sudo pip install neovim
  curl -fLo ~/.config/nvim/autoload/plug.vim --create-dirs \
    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim && \
    nvim '+PlugUpdate' '+PlugClean!' '+qall'
fi

# BASE 16 SHELL
if [ `ls -A ~/.config/base16-shell/ | wc -m` == "0" ]; then
  echo "installing BASE16 Shell"
  git clone https://github.com/chriskempson/base16-shell.git ~/.config/base16-shell
fi

# Rbenv
if command -v rbenv >/dev/null 2>&1; then
  echo "Bootstraping rbenv"
  curl -fsSL https://github.com/rbenv/rbenv-installer/raw/master/bin/rbenv-installer | bash

  mkdir -p "$(rbenv root)/plugins"
  git clone https://github.com/znz/rbenv-plug.git "$(rbenv root)/plugins/rbenv-plug"
  rbenv plug ctags
  rbenv plug default-gems
  rbenv plug ruby-build
  rbenv plug update

  rbenv ctags
fi

# DESKTOP
read -r -p "Bootstrap gnome-shell? [y/N] " response
response=${response,,}
if [[ "$response" =~ ^(yes|y)$ ]]; then
  sudo pacman -S gpaste --no-confirm --needed
  yaourt -S gnome-shell-extension-installer --no-confirm --needed

  gnome-shell-extension-installer 307  # Dash to dock
  gnome-shell-extension-installer 2    # Move Clock
  gnome-shell-extension-installer 1295 # Google earth wallpaper
  gnome-shell-extension-installer 1031 # TopIcons Plus
  gnome-shell-extension-installer 826  # Suspend button
  gnome-shell-extension-installer 906  # Sound Input & Output Device Chooser 
  gnome-shell-extension-installer 905  # Refresh Wifi Connections
  gnome-shell-extension-installer 258  # Notifications Alert 
  gnome-shell-extension-installer 1267 # No Title Bar
  gnome-shell-extension-installer 55   # Media Player Indicator
  gnome-shell-extension-installer 1007 # 'Window Is Ready' Notification Remover
  gnome-shell-extension-installer 53   # Pomodoro
fi

# TODO:
# configure theme
# dconf config (keyboard shortcuts, etc)

# TODO: Improve
read -r -p "Install Basic Desktop apps? [y/N] " response
response=${response,,}
if [[ "$response" =~ ^(yes|y)$ ]]; then
  yaourt -S dropbox gnome-mpv gnome-tweak-tool gnome-shell-pomodoro \
    google-chrome gpaste simplenote-electron-bin slack-desktop \
    paper-icon-theme ttf-iosevka-term bitwarden --no-confirm --needed
fi

# TODO: Improve
read -r -p "Install Extra packages? [y/N] " response
response=${response,,}
if [[ "$response" =~ ^(yes|y)$ ]]; then
  yaourt -S acestream-engine acestream-launcher android-file-transfer \
    android-tools aria2 calibre chrome-gnome-shell darktable dconf-editor \
    geeqie htop intel-ucode linux-firmware linux-lts linux-lts-headers \
    linux-zen linux-zen-headers meld ntfs-3g nvm pgadmin4 pinta \
    popcorntime-bin rapid-photo-downloader skypeforlinux-bin spotify steam \
    steam-native-runtime stremio-legacy subdownloader sublime-text-dev \
    subliminal telegram-desktop-bin termite-git termite-terminfo-git \
    transmission-cli transmission-gtk trash-cli unified-remote-server \
    vulkan-icd-loader vulkan-intel wget wine wine-mono winetricks yarn yay \
    zoom etcher --no-confirm --needed
fi
