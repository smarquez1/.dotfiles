#!/bin/bash
SYSTEM_TYPE=$(uname -s)

# Load Decisiv configs
source ~/code/decisiv/.profile

# Okta aws
source "$HOME/.okta/bash_functions"
# PATH="$HOME/.okta/bin:$PATH"

## Teleport shortcuts
alias dcvlogin="tsh --proxy=decisiv.sh:443 login --auth=okta"

# Ex dcvls builder qa
dcvls() {
	tsh ls app=$1,env=$2
}

# Ex tshd builder-app-dev-1.dev.decisivapps.com
# Ex2 tshd builder-app-dev-1.dev.decisivapps.com tmux a
dcvsh() {
  tsh ssh --cluster=decisiv developers@$1 $2
}

dcvshd() {
  tsh ssh --cluster=decisiv developers@$1.decisivapps.com
}

# run decisiiv services
dcvserv() {
  (cd ~/code/decisiv/decisiv-services && be services bootstrap && be services start)
}

# start pricing
dcvstart() {
  dcvserv
  brew services start memcached
  brew services start redis
  brew services start postgresql@9.6

  (tail -f ~/code/decisiv/pricing/log/development.log -f ~/code/decisiv/portal/log/development.log)
}

# stop pricing
dcvstop() {
  (cd ~/code/decisiv/decisiv-services && be services stop)
}

# if [ "$SYSTEM_TYPE" = "Darwin" ]; then
#   export PATH="/usr/local/opt/postgresql@9.6/bin:$PATH"
# fi
